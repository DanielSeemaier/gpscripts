# -*- shell-script -*-

# TODO does not seem to work?
function run_partitioner {
    optype=1
    adapthfactor=0
    ipc2redist=0
    dbglevel=3

    require_arg "np"
    if [[ "$epsilon" != "3" ]]; then
       echo "unsupported imbalance: $epsilon"
       exit 1
    fi
    if [[ "$args" != "" ]]; then
	echo "unsupported additional arguments: $args"
	exit 1
    fi

    bin=$(get_binary parmetis)
    cmd="mpirun -np $np $bin $graph $optype $k $adapthfactor $ipc2redist $dbglevel $seed"

    echo "running $cmd"
    eval $cmd

    verifier=$(get_binary VerifyPartition)
    cmd="VerifyPartition $graph $graph.part"
    if [[ "$k" != "2" ]]; then
	cmd="${cmd}.$k"
    fi
    echo "evaluating: $cmd"
    eval $cmd
}
